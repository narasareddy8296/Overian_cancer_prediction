<!DOCTYPE html>
<html>
<head>
    <title>Cancer Risk Assessment</title>
    <!-- Add Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50">
    <div class="max-w-4xl mx-auto p-6 space-y-8">
        <h1 class="text-3xl font-bold text-gray-900 text-center mb-8">Cancer Risk Assessment</h1>
        
        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6 text-blue-800">
            ðŸ“‹ Sample values have been pre-filled in the form below. You can edit or delete these values to enter your own data.
        </div>

        <form id="assessment-form" class="space-y-6 bg-white shadow-md rounded-lg p-6">
            <div class="grid md:grid-cols-2 gap-6">
                <div class="space-y-2">
                    <label for="patient_id" class="block text-sm font-medium text-gray-700">Patient ID:</label>
                    <input type="number" id="patient_id" name="patient_id" value="999" required
                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                </div>
                
                <div class="space-y-2">
                    <label for="age" class="block text-sm font-medium text-gray-700">Patient Age:</label>
                    <input type="number" id="age" name="age" value="45" required
                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                </div>
                
                <div class="space-y-2">
                    <label for="afp" class="block text-sm font-medium text-gray-700">Alpha-Fetoprotein (AFP) Level (ng/mL):</label>
                    <input type="number" id="afp" name="afp" step="0.1" value="2.5" required
                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                </div>
                
                <div class="space-y-2">
                    <label for="alb" class="block text-sm font-medium text-gray-700">Albumin (ALB) Level (g/dL):</label>
                    <input type="number" id="alb" name="alb" step="0.1" value="4.2" required
                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                </div>
                
                <div class="space-y-2">
                    <label for="alt" class="block text-sm font-medium text-gray-700">Alanine Aminotransferase (ALT) (U/L):</label>
                    <input type="number" id="alt" name="alt" step="0.1" value="15.0" required
                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                </div>
                
                <div class="space-y-2">
                    <label for="ast" class="block text-sm font-medium text-gray-700">Aspartate Aminotransferase (AST) (U/L):</label>
                    <input type="number" id="ast" name="ast" step="0.1" value="20.0" required
                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                </div>
                
                <div class="space-y-2">
                    <label for="plt" class="block text-sm font-medium text-gray-700">Platelet Count (PLT) (K/ÂµL):</label>
                    <input type="number" id="plt" name="plt" value="250" required
                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                </div>
                
                <div class="space-y-2">
                    <label for="menopause" class="block text-sm font-medium text-gray-700">Menopausal Status:</label>
                    <select id="menopause" name="menopause" required
                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                        <option value="0" selected>No</option>
                        <option value="1">Yes</option>
                    </select>
                </div>
                
                <div class="space-y-2">
                    <label for="baso_count" class="block text-sm font-medium text-gray-700">Basophil Count (BASO#) (K/ÂµL):</label>
                    <input type="number" id="baso_count" name="baso_count" step="0.01" value="0.02" required
                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                </div>
                
                <div class="space-y-2">
                    <label for="baso_percent" class="block text-sm font-medium text-gray-700">Basophil Percentage (BASO%) (%):</label>
                    <input type="number" id="baso_percent" name="baso_percent" step="0.1" value="0.3" required
                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                </div>
            </div>

            <div class="flex gap-4 pt-4">
                <button type="submit" 
                    class="flex-1 bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-md transition duration-150 ease-in-out">
                    Analyze Results
                </button>
                <button type="reset" 
                    class="flex-1 bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-md transition duration-150 ease-in-out">
                    Clear Form
                </button>
            </div>
        </form>

        <div id="result-container" class="mt-6"></div>
    </div>

    <script>
        function clearResults() {
            document.getElementById('result-container').innerHTML = '';
        }

        document.getElementById('assessment-form').addEventListener('submit', function(e) {
            e.preventDefault();
            clearResults(); // Clear previous results
            const formData = new FormData(this);
            
            // Show loading state
            document.getElementById('result-container').innerHTML = `
                <div class="animate-pulse rounded-lg border p-6 text-center bg-gray-50">
                    <p class="text-gray-600">Analyzing results...</p>
                </div>
            `;
            
            fetch('/predict_lab', {
                method: 'POST',
                body: formData,
                cache: 'no-store' // Prevent caching of results
            })
            .then(response => response.text())
            .then(html => {
                document.getElementById('result-container').innerHTML = html;
            })
            .catch(error => {
                document.getElementById('result-container').innerHTML = `
                    <div class="bg-red-50 border border-red-200 text-red-800 rounded-lg p-4">
                        Error: ${error.message}
                    </div>`;
            });
        });

        // Clear results when form is reset
        document.getElementById('assessment-form').addEventListener('reset', function(e) {
            clearResults();
        });

        // Clear results when any input changes
        document.querySelectorAll('#assessment-form input, #assessment-form select').forEach(input => {
            input.addEventListener('change', clearResults);
        });
    </script>
</body>
</html>
